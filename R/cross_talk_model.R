
library(deSolve)
dynamicmodel <- function(lambda, y, parms){
  dy1 <- 337.23*(0.00092235-y[2]-y[1]-y[3]-y[4]-y[7])*(0.000079433-y[1]) - (337.23+261.1)*y[1] + 0.000001*y[17] - 0.00002*y[8]
  dy2 <- 146.07*y[1] - 1841*y[2]*(0.0003283-y[3]) + 198.47*y[3] - 122.6*y[3]*(5.1288-y[5]-y[8]-y[4]-y[7]-y[6]-y[9]-y[10]-y[13]) +(420+623.17)*y[4] - 3387*y[5]*y[2]+(214.65+605.31)*y[7]-0.00001*(1-y[16])
  dy3 <- 1841*y[2]*(0.0003283-y[3]) - (198.47+338.44)*y[3]
  dy4 <- 1226*(5.1288-y[5]-y[8]-y[4]-y[7]-y[6]-y[9]-y[10]-y[13])*y[2] - (623.17+420)*y[4]
  dy5 <- 420*y[4] - 2960.3*y[5]*(0.00021238-y[6]-y[9]) + 163*y[9] - 3383.7*y[5]*y[2] + 605.31*y[7] + 67.97*y[6]
  dy6 <- 2960.3*y[5]*(0.00021238-y[6]-y[9]) - (163+668.2)*y[6]
  dy7 <- 3383.7*y[7] - (605.31+214.65)*y[7]
  dy8 <- 214.65*y[7]-1956.8*y[8]*(5.1288-y[5]-y[8]-y[4]-y[7]-y[6]-y[9]-y[10]-y[13])+48.804*y[6]-229.57*y[8]*(0.81552-y[11]-y[14]-y[10]-y[12]-y[15])+(694.13+43.658)*y[10]-338.87*y[11]*y[8]+(485.35+65.732)*y[13]
  dy9 <- 1956.8*y[8]*(5.1288-y[5]-y[8]-y[4]-y[7]-y[6]-y[9]-y[10]-y[13]) - (48.804+67.97)*y[9]
  dy10 <- 229.57*(0.81552-y[11]-y[14]-y[10]-y[12]-y[15])*y[8] - (694.13+43.658)*y[10]
  dy11 <- 43.658*y[10] - 297*y[11]*(0.50345-y[12]-y[15]) + 301.09*y[12] - 338.87*y[11]*y[8] + 485.35*y[13] - 175.91*y[15]
  dy12 <- 297*y[11]*(0.50345-y[12]-y[15]) - (301.09+31.743)*y[12]
  dy13 <- 338.87*y[11]*y[8] - (485.35+65.732)*y[13]
  dy14 <- 65.732*y[13] - 974.7*y[14]*(0.50345-y[12]-y[15]) + 587.45*y[15]
  dy15 <- 974.4*y[14]*(0.50345-y[12]-y[15]) - (587.45+175.91)*y[15]
  
  dy16 <- -20*y[16]*(y[17] - y[16]*y[17]/(0.05+y[16])) + 0.0909*y[16]*y[17]/(0.05+y[16]) + 0.9091*(1-y[16])/(0.05+1-y[16])
  dy17 <- lambda + (1 - 0.01*0.559 - 0.559*5*y[14])*(1-y[16]) - 0.1*y[14] - y[17]
  list(c(dy1, dy2, dy3, dy4, dy5, dy6, dy7, dy8, dy9, dy10, dy11, dy12, dy13, dy14, dy15, dy16, dy17))
}

yi <- c(y1 = 0, y2 = 0, y3 = 0, y4 = 0, y5 = 0, y6 = 0, y7 =0, y8 = 0, y9 = 0, y10 = 0, y11 = 0, y12 = 0, y13 = 0, y14 = 0, y15 = 0, y16 = 1, y17 = 1)

lambda <- seq(0,1,0.01)
time <- seq(0,1,0.01)

out <- ode(times = time, y = yi, func = dynamicmodel, parms = NULL)

plot(lambda, out[,'y16'])

# y1 = KKK.E1 
# y2 = KKK*
# y3 = KKK*.E2 
# y4 = KK.KKK* 
# y5 = KK - P 
# y6 = KK - P.KKP'ase 
# y7 = KK - P.KKK* 
# y8 = KK - PP 
# y9 = KK - PP.KKP'ase
# y10 = K.KK - PP 
# y11 = K - P 
# y12 = K - P.KP'ase 
# y13 = K - P.KK - PP 
# y14 = K - PP (ERK)  
# y15 = K - PP.KP'ase 

#y16 = AKT 
#y17 = pIRS1 

#E1tot = 0.000079433
#E2tot = 0.0003283 

#KKKtot = 0.00092235
#KKtot = 5.1288
#Ktot = 0.81552 

#  Interactions parameters 
# k1 = 0.000001
# k2 = 5
# k3 = 0.1
# k4 = 0.00001
# k5 = 0.00002
